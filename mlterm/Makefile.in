BUILD_TOPDIR = ..

prefix = @prefix@
exec_prefix = @exec_prefix@
libdir = @libdir@

SRC_TOPDIR = @SRC_TOPDIR@

CC = @CC@
LIBTOOL = @LIBTOOL@
INSTALL = @INSTALL@

PREFIX = $(DESTDIR)$(prefix)
LIBDIR = $(DESTDIR)$(libdir)
INCDIR = $(DESTDIR)$(PREFIX)/include

VPATH = $(SRC_TOPDIR)/mlterm

INCDIR_TMP = $(BUILD_TOPDIR)/include

CFLAGS = $(CFLAGS_LOCAL) @DEB_CFLAGS@ @KIK_CFLAGS@ @MKF_CFLAGS@ @FRIBIDI_CFLAGS@ @IND_CFLAGS@ \
	@UTMP_CFLAGS@ @CFLAGS@ -I/usr/local/include
LIBS = $(LIBS_LOCAL)

OBJ = ml_bidi.o ml_char.o ml_char_encoding.o ml_color.o ml_edit.o ml_edit_intern.o ml_edit_scroll.o \
	ml_iscii.o ml_line.o ml_logical_visual.o ml_logs.o ml_model.o ml_pty.o ml_render_hint.o \
	ml_screen.o ml_shape.o ml_str_parser.o ml_term.o ml_vt100_parser.o ml_term_factory.o \
	ml_config_menu.o

INC = $(OBJ:.o=.h)

LIBNAME = libmlterm
LIBNAME_DEB = libmlterm_deb
MAJOR = 0
MINOR = 0

LIBTOOL_CC = $(LIBTOOL) --mode=compile $(CC) $(CFLAGS)
LIBTOOL_LINK = $(LIBTOOL) --mode=link $(CC)
LIBTOOL_INSTALL = $(LIBTOOL) --mode=install $(INSTALL)


all : $(LIBNAME).a

debug :
	$(MAKE) LIBNAME=$(LIBNAME_DEB) $(LIBNAME_DEB).a

$(LIBNAME).a : $(OBJ)
	$(LIBTOOL_LINK) -o $(LIBNAME).a $(OBJ) $(LIBS)

install :

clean :
	rm -rf $(OBJ) $(OBJ:.o=.lo) .libs *.a

wc :
	find . -name "*.[ch]" -a \! -name "test_*" | xargs wc -l

.SUFFIXES : .c.o

.c.o :
	$(LIBTOOL_CC) -c $<
