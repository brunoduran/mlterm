top_builddir = ../..
top_srcdir = @top_srcdir@
prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@

VPATH = ${top_srcdir}/tool/mlclient

LKIK = @LKIK@
LKIK_DEB = -lkik_deb

CC = @CC@
LIBTOOL = @LIBTOOL@
CFLAGS = @KIK_CFLAGS@ @CFLAGS@ @CPPFLAGS@ @GUI_CFLAGS@
LIBS = $(LKIK) @SOCK_LIBS@
INSTALL = @INSTALL@

BINDIR = $(DESTDIR)$(bindir)

OBJ = main.o

PROG = mlclient

LIBTOOL_CC = $(LIBTOOL) --mode=compile $(CC) $(CFLAGS)
LIBTOOL_LINK = $(LIBTOOL) --mode=link $(CC) @LDFLAGS@
LIBTOOL_INSTALL = $(LIBTOOL) --mode=install $(INSTALL)

all: $(PROG)

$(PROG): $(OBJ)
	$(LIBTOOL_LINK) -o $(PROG) $(OBJ:.o=.lo) $(LIBS)
	$(LIBTOOL_LINK) -o $(PROG)x $(OBJ:.o=.lo) $(LIBS)

.SUFFIXES: .c.o

.c.o:
	$(LIBTOOL_CC) $(CFLAGS) -c $<

clean:
	rm -f $(OBJ) $(PROG) $(PROG).exe $(PROG)x $(PROG)x.exe *core 

distclean: clean
	rm -f Makefile

$(BINDIR):
	mkdir -p $(BINDIR)

install: $(BINDIR)
	$(LIBTOOL_INSTALL) -m 755 $(PROG) $(PROG)x $(BINDIR)

uninstall:
	rm -f $(BINDIR)/$(PROG) $(BINDIR)/$(PROG)x
